!function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t,n){var r=/\b(Array|Date|Object|Math|JSON)\b/g;t.exports=function(e,t){var n,i=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}((n=e,n.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(r,"").match(/[a-zA-Z_]\w*/g)||[]));t&&"string"==typeof t&&(o=t,t=function(e){return o+e});var o;if(t)return u=e,a=i,s=t,u.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,function(e){return"("==e[e.length-1]?s(e):~a.indexOf(e)?s(e):e});var u,a,s;return i}},{}],2:[function(e,t,n){(function(r){(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,r)},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=i,n.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};function i(){var e;try{e=n.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}n.enable(i())}).call(this,e("_process"))},{"./debug":3,_process:7}],3:[function(e,t,n){(n=t.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e),n.names=[],n.skips=[];var t,r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var o=n.instances[t];o.enabled=n.enabled(o.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.instances=[],n.names=[],n.skips=[],n.formatters={};function r(e){var t;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(t||i);e.diff=o,e.prev=t,e.curr=i,t=i;for(var u=new Array(arguments.length),a=0;a<u.length;a++)u[a]=arguments[a];u[0]=n.coerce(u[0]),"string"!=typeof u[0]&&u.unshift("%O");var s=0;u[0]=u[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;s++;var i=n.formatters[r];if("function"==typeof i){var o=u[s];t=i.call(e,o),u.splice(s,1),s--}return t}),n.formatArgs.call(e,u);(r.log||n.log||console.log.bind(console)).apply(e,u)}}return r.namespace=e,r.enabled=n.enabled(e),r.useColors=n.useColors(),r.color=function(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[Math.abs(r)%n.colors.length]}(e),r.destroy=i,"function"==typeof n.init&&n.init(r),n.instances.push(r),r}function i(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}},{ms:5}],4:[function(e,t,n){var r=e("to-function");t.exports=function(e,t){var n,i={};t=r(t);for(var o=0;o<e.length;++o)i[n=t(e[o],o)]=i[n]||[],i[n].push(e[o]);return i}},{"to-function":8}],5:[function(e,t,n){var r=1e3,i=60*r,o=60*i,u=24*o,a=365.25*u;t.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*a;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?s(c=e,u,"day")||s(c,o,"hour")||s(c,i,"minute")||s(c,r,"second")||c+" ms":function(e){if(e>=u)return Math.round(e/u)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);var c;throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}},{}],6:[function(e,t,n){!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=n():"function"==typeof define&&define.amd?define([],n):e.objectPath=n()}(this,function(){"use strict";var e=Object.prototype.toString;function t(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)}function n(e){if(!e)return!0;if(i(e)&&0===e.length)return!0;if("string"!=typeof e){for(var n in e)if(t(e,n))return!1;return!0}return!1}function r(t){return e.call(t)}var i=Array.isArray||function(t){return"[object Array]"===e.call(t)};function o(e){var t=parseInt(e);return t.toString()===e?t:e}function u(e){e=e||{};var u=function(e){return Object.keys(u).reduce(function(t,n){return"create"===n?t:("function"==typeof u[n]&&(t[n]=u[n].bind(u,e)),t)},{})};function a(n,r){return e.includeInheritedProps||"number"==typeof r&&Array.isArray(n)||t(n,r)}function s(e,t){if(a(e,t))return e[t]}function c(e,t,n,r){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if("string"==typeof t)return c(e,t.split(".").map(o),n,r);var i=t[0],u=s(e,i);return 1===t.length?(void 0!==u&&r||(e[i]=n),u):(void 0===u&&("number"==typeof t[1]?e[i]=[]:e[i]={}),c(e[i],t.slice(1),n,r))}return u.has=function(n,r){if("number"==typeof r?r=[r]:"string"==typeof r&&(r=r.split(".")),!r||0===r.length)return!!n;for(var u=0;u<r.length;u++){var a=o(r[u]);if(!("number"==typeof a&&i(n)&&a<n.length||(e.includeInheritedProps?a in Object(n):t(n,a))))return!1;n=n[a]}return!0},u.ensureExists=function(e,t,n){return c(e,t,n,!0)},u.set=function(e,t,n,r){return c(e,t,n,r)},u.insert=function(e,t,n,r){var o=u.get(e,t);r=~~r,i(o)||(o=[],u.set(e,t,o)),o.splice(r,0,n)},u.empty=function(e,t){if(!n(t)&&null!=e){var o,s;if(o=u.get(e,t)){if("string"==typeof o)return u.set(e,t,"");if("boolean"==typeof(l=o)||"[object Boolean]"===r(l))return u.set(e,t,!1);if("number"==typeof o)return u.set(e,t,0);if(i(o))o.length=0;else{if("object"!=typeof(c=o)||"[object Object]"!==r(c))return u.set(e,t,null);for(s in o)a(o,s)&&delete o[s]}var c,l}}},u.push=function(e,t){var n=u.get(e,t);i(n)||(n=[],u.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},u.coalesce=function(e,t,n){for(var r,i=0,o=t.length;i<o;i++)if(void 0!==(r=u.get(e,t[i])))return r;return n},u.get=function(e,t,n){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if(null==e)return n;if("string"==typeof t)return u.get(e,t.split("."),n);var r=o(t[0]),i=s(e,r);return void 0===i?n:1===t.length?i:u.get(e[r],t.slice(1),n)},u.del=function(e,t){if("number"==typeof t&&(t=[t]),null==e)return e;if(n(t))return e;if("string"==typeof t)return u.del(e,t.split("."));var r=o(t[0]);return a(e,r)?1!==t.length?u.del(e[r],t.slice(1)):(i(e)?e.splice(r,1):delete e[r],e):e},u}var a=u();return a.create=u,a.withInheritedProps=u({includeInheritedProps:!0}),a})},{}],7:[function(e,t,n){var r,i,o=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var c,l=[],f=!1,h=-1;function d(){f&&c&&(f=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!f){var e=s(d);f=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||f||s(p)};function g(e,t){this.fun=e,this.array=t}g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={};function y(){}o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],8:[function(e,t,n){var r;try{r=e("props")}catch(t){r=e("component-props")}t.exports=i;function i(e){switch({}.toString.call(e)){case"[object Object]":return function(e){var t={};for(var n in e)t[n]="string"==typeof e[n]?o(e[n]):i(e[n]);return function(e){if("object"!=typeof e)return!1;for(var n in t){if(!(n in e))return!1;if(!t[n](e[n]))return!1}return!0}}(e);case"[object Function]":return e;case"[object String]":return/^ *\W+/.test(n=e)?new Function("_","return _ "+n):new Function("_","return "+function(e){var t=r(e);if(!t.length)return"_."+e;var n,i,o;for(i=0;i<t.length;i++)o=t[i],e=u(o,e,n="('function' == typeof "+(n="_."+o)+" ? "+n+"() : "+n+")");return e}(n));case"[object RegExp]":return t=e,function(e){return t.test(e)};default:return o(e)}var t,n}function o(e){return function(t){return e===t}}function u(e,t,n){return t.replace(new RegExp("(\\.)?"+e,"g"),function(e,t){return t?e:n})}},{"component-props":1,props:1}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={storage:"localstorage",prefix:"sq_jobs",timeout:1e3,limit:-1,principle:"fifo",network:!1,debug:!0}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./config.data"),u=(r=o,r&&r.__esModule?r:{default:r});var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=u.default,this.merge(t)}return i(e,[{key:"set",value:function(e,t){this.config[e]=t}},{key:"get",value:function(e){return this.config[e]}},{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.config,e)}},{key:"merge",value:function(e){this.config=Object.assign({},this.config,e)}},{key:"remove",value:function(e){return delete this.config[e]}},{key:"all",value:function(){return this.config}}]),e}();n.default=a},{"./config.data":9}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container={}}return r(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this._container,e)}},{key:"get",value:function(e){return this._container[e]}},{key:"all",value:function(){return this._container}},{key:"bind",value:function(e,t){this._container[e]=t}},{key:"remove",value:function(e){return!!this.has(e)&&delete this._container[e]}},{key:"removeAll",value:function(){this._container={}}}]),e}();n.default=i},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={queue:{created:"New task created.",next:"Next task processing.",starting:"Queue listener starting.",stopping:"Queue listener stopping.",stopped:"Queue listener stopped.",empty:"channel is empty...","not-found":"job not found"},event:{created:"New event created",fired:"Event fired.","wildcard-fired":"Wildcard event fired."}}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store={},this.verifierPattern=/^[a-z0-9\-\_]+\:before$|after$|retry$|\*$/,this.wildcards=["*","error"],this.emptyFunc=function(){},this.store.before={},this.store.after={},this.store.retry={},this.store.wildcard={},this.store.error=this.emptyFunc,this.store["*"]=this.emptyFunc}return r(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new Error("Event should be an function");this.isValid(e)&&this.add(e,t)}},{key:"emit",value:function(e,t){if(this.wildcards.indexOf(e)>-1)this.wildcard.apply(this,[e].concat(Array.prototype.slice.call(arguments)));else{var n=this.getType(e),r=this.getName(e);if(this.store[n]){(this.store[n][r]||this.emptyFunc).call(null,t)}}this.wildcard("*",e,t)}},{key:"wildcard",value:function(e,t,n){this.store.wildcard[e]&&this.store.wildcard[e].call(null,t,n)}},{key:"add",value:function(e,t){if(this.wildcards.indexOf(e)>-1)this.store.wildcard[e]=t;else{var n=this.getType(e),r=this.getName(e);this.store[n][r]=t}}},{key:"has",value:function(e){try{var t=e.split(":");return t.length>1?!!this.store[t[1]][t[0]]:!!this.store.wildcard[t[0]]}catch(e){return!1}}},{key:"getName",value:function(e){return e.match(/(.*)\:.*/)[1]}},{key:"getType",value:function(e){return e.match(/^[a-z0-9\-\_]+\:(.*)/)[1]}},{key:"isValid",value:function(e){return this.verifierPattern.test(e)||this.wildcards.indexOf(e)>-1}}]),e}();n.default=i},{}],14:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.getTasksWithoutFreezed=function(){return c.call(this).all().filter(a.excludeSpecificTasks.bind(["freezed"]))},n.db=c,n.logProxy=l,n.saveTask=function(e){return c.call(this).save(d(e))},n.removeTask=f,n.dispatchEvents=h,n.checkPriority=d,n.createTimeout=function(){clearTimeout(this.currentTimeout);var e=c.call(this).fetch().shift();if(void 0===e)return l.call(this,"queue.empty",this.currentChannel),y.call(this),1;if(!this.container.has(e.handler))return l.call(this,"queue.not-found",e.handler),b.call(this,e).call(),1;var t=this.container.get(e.handler),n=new t.handler,r=n.timeout||this.config.get("timeout"),i=p.call(this,e,t,n).bind(this);return this.currentTimeout=setTimeout(i,r)},n.loopHandler=p,n.lockTask=g,n.stopQueue=y,n.fireJobInlineEvent=v,n.successJobHandler=m,n.failedJobHandler=b,n.dispatchProcess=C,n.successProcess=w,n.statusOff=function(){this.running=!1},n.retryProcess=F,n.canMultiple=function(e){return"object"!==(void 0===e?"undefined":o(e))||!0!==e.unique||this.hasByTag(e.tag)<1},n.updateRetry=k,n.registerJobs=function(){if(u.default.isRegistered)return;var e=u.default.jobs||[],t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value,c=s.handler.toString(),l=c.match(/function\s([a-zA-Z_]+).*?/),f=i(l,2),h=(f[0],f[1]);h&&this.container.bind(h,s)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}u.default.isRegistered=!0};var u=s(e("./queue")),a=e("./utils");s(e("./storage-capsule"));function s(e){return e&&e.__esModule?e:{default:e}}function c(){return this.storage.channel(this.currentChannel)}function l(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];a.log.call.apply(a.log,[this.config.get("debug")].concat(Array.prototype.slice.call(arguments)))}function f(e){return c.call(this).delete(e)}function h(e,t){if(!("tag"in e))return!1;var n=[[e.tag+":"+t,"fired"],[e.tag+":*","wildcard-fired"]],r=!0,i=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var s=u.value;this.event.emit(s[0],e),l.call(this,"event."+s[1],s[0])}}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}}function d(e){return e.priority=e.priority||0,isNaN(e.priority)&&(e.priority=0),e}function p(e,t,n){var r=this;return function(){var i,o=r;g.call(o,e),v.call(r,"before",n,e.args),h.call(r,e,"before");var u=Object.values(t.deps||{});(i=n.handle).call.apply(i,[n,e.args].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(u))).then(m.call(o,e,n).bind(o)).catch(b.call(o,e,n).bind(o))}}function g(e){return c.call(this).update(e._id,{locked:!0})}function y(){this.stop(),clearTimeout(this.currentTimeout),l.call(this,"queue.stopped","stop")}function v(e,t,n){if(!(0,a.hasMethod)(t,e))return!1;"before"==e&&(0,a.isFunction)(t.before)?t.before.call(t,n):"after"==e&&(0,a.isFunction)(t.after)&&t.after.call(t,n)}function m(e,t){var n=this;return function(r){C.call(n,r,e,t),v.call(n,"after",t,e.args),h.call(n,e,"after"),n.next()}}function b(e,t){var n=this;return function(t){f.call(n,e._id),n.event.emit("error",e),n.next()}}function C(e,t,n){e?w.call(this,t,n):F.call(this,t,n)}function w(e,t){f.call(this,e._id)}function F(e,t){h.call(this,e,"retry");var n=k.call(this,e,t);return n.locked=!1,c.call(this).update(e._id,n)}function k(e,t){return"retry"in t||(t.retry=1),"tried"in e||(e.tried=0,e.retry=t.retry),++e.tried,e.tried>=t.retry&&(e.freezed=!0),e}},{"./queue":16,"./storage-capsule":17,"./utils":19}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./queue"),o=(r=i,r&&r.__esModule?r:{default:r});window.Queue=o.default,n.default=o.default},{"./queue":16}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=l(e("./storage/localstorage")),i=l(e("./container")),o=l(e("./storage-capsule")),u=l(e("./config")),a=l(e("./event")),s=e("./utils"),c=e("./helpers");function l(e){return e&&e.__esModule?e:{default:e}}var f=function(){e.FIFO="fifo",e.LIFO="lifo";function e(e){(function(e){this.channels={},this.config=new u.default(e),this.storage=new o.default(this.config,new r.default(this.config)),this.timeout=this.config.get("timeout")}).call(this,e)}return e.prototype.currentChannel,e.prototype.currentChannel,e.prototype.stopped=!0,e.prototype.running=!1,e.prototype.event=new a.default,e.prototype.container=new i.default,e.prototype.add=function(e){if(!c.canMultiple.call(this,e))return!1;var t=c.saveTask.call(this,e);return t&&this.stopped&&!0===this.running&&(console.log("WWEEE",t,this.stopped,this.running),this.start()),c.logProxy.call(this,"queue.created",e.handler),t},e.prototype.next=function(){if(this.stopped)return c.statusOff.call(this),c.stopQueue.call(this);c.logProxy.call(this,"queue.next","next"),this.start()},e.prototype.start=function(){return this.stopped=!1,c.registerJobs.call(this),c.logProxy.call(this,"queue.starting","start"),this.running=c.createTimeout.call(this)>0,this.running},e.prototype.stop=function(){c.logProxy.call(this,"queue.stopping","stop"),this.stopped=!0},e.prototype.forceStop=function(){c.stopQueue.call(this)},e.prototype.create=function(e){return e in this.channels||(this.currentChannel=e,this.channels[e]=(0,s.clone)(this)),this.channels[e]},e.prototype.channel=function(e){if(!this.channels[e])throw new Error('Channel of "'+e+'" not found');return this.channels[e]},e.prototype.isEmpty=function(){return this.count()<1},e.prototype.count=function(){return c.getTasksWithoutFreezed.call(this).length},e.prototype.countByTag=function(e){return c.getTasksWithoutFreezed.call(this).filter(function(t){return t.tag===e}).length},e.prototype.clear=function(){return!!this.currentChannel&&(this.storage.clear(this.currentChannel),!0)},e.prototype.clearByTag=function(e){var t=this;c.db.call(this).all().filter(s.utilClearByTag.bind(e)).forEach(function(e){return c.db.call(t).delete(e._id)})},e.prototype.has=function(e){return c.getTasksWithoutFreezed.call(this).findIndex(function(t){return t._id===e})>-1},e.prototype.hasByTag=function(e){return c.getTasksWithoutFreezed.call(this).findIndex(function(t){return t.tag===e})>-1},e.prototype.setTimeout=function(e){this.timeout=e,this.config.set("timeout",e)},e.prototype.setLimit=function(e){this.config.set("limit",e)},e.prototype.setPrefix=function(e){this.config.set("prefix",e)},e.prototype.setPrinciple=function(e){this.config.set("principle",e)},e.prototype.setDebug=function(e){this.config.set("debug",e)},e.prototype.on=function(e,t){var n;(n=this.event).on.apply(n,arguments),c.logProxy.call(this,"event.created",e)},e.register=function(t){if(!(t instanceof Array))throw new Error("Queue jobs should be objects within an array");e.isRegistered=!1,e.jobs=t},e}();n.default=f},{"./config":10,"./container":11,"./event":13,"./helpers":14,"./storage-capsule":17,"./storage/localstorage":18,"./utils":19}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(e("group-by")),o=(u(e("./storage/localstorage")),u(e("./config")),e("./utils"));function u(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage=n,this.config=t}return r(e,[{key:"channel",value:function(e){return this.storageChannel=e,this}},{key:"fetch",value:function(){var e=this.all().filter(o.excludeSpecificTasks),t=(0,i.default)(e,"priority");return Object.keys(t).map(function(e){return parseInt(e)}).sort(function(e,t){return t-e}).reduce(this.reduceTasks(t),[])}},{key:"save",value:function(e){var t=this.storage.get(this.storageChannel);return this.isExceeded()?(console.warn("Task limit exceeded: The '"+this.storageChannel+"' channel limit is "+this.config.get("limit")),!1):(e=this.prepareTask(e),t.push(e),this.storage.set(this.storageChannel,JSON.stringify(t)),e._id)}},{key:"update",value:function(e,t){var n=this.all(),r=n.findIndex(function(t){return t._id==e});return!(r<0)&&(n[r]=Object.assign({},n[r],t),this.storage.set(this.storageChannel,JSON.stringify(n)),!0)}},{key:"delete",value:function(e){var t=this.all(),n=t.findIndex(function(t){return t._id===e});return!(n<0)&&(delete t[n],this.storage.set(this.storageChannel,JSON.stringify(t.filter(function(e){return e}))),!0)}},{key:"all",value:function(){return this.storage.get(this.storageChannel)}},{key:"generateId",value:function(){return(65536*(1+Math.random())).toString(16)}},{key:"prepareTask",value:function(e){return e.createdAt=Date.now(),e._id=this.generateId(),e}},{key:"reduceTasks",value:function(e){var t=this;return function(n,r){return"lifo"===t.config.get("principle")?n.concat(e[r].sort(o.lifo)):n.concat(e[r].sort(o.fifo))}.bind(this)}},{key:"isExceeded",value:function(){var e=this.config.get("limit"),t=this.all().filter(o.excludeSpecificTasks);return!(-1===e||e>t.length)}},{key:"clear",value:function(e){this.storage.clear(e)}}]),e}();n.default=a},{"./config":10,"./storage/localstorage":18,"./utils":19,"group-by":4}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage=localStorage,this.config=t}return r(e,[{key:"get",value:function(e){try{var t=this.storageName(e);return this.has(t)?JSON.parse(this.storage.getItem(t)):[]}catch(e){return[]}}},{key:"set",value:function(e,t){this.storage.setItem(this.storageName(e),t)}},{key:"has",value:function(e){return e in this.storage}},{key:"clear",value:function(e){this.storage.removeItem(this.storageName(e))}},{key:"clearAll",value:function(){this.storage.clear()}},{key:"storageName",value:function(e){return this.getPrefix()+"_"+e}},{key:"getPrefix",value:function(){return this.config.get("prefix")}}]),e}();n.default=i},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.clone=function(e){var t=Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyNames(e).reduce(function(t,n){return t[n]=Object.getOwnPropertyDescriptor(e,n),t},{}));Object.isExtensible(e)||Object.preventExtensions(t);Object.isSealed(e)&&Object.seal(t);Object.isFrozen(e)&&Object.freeze(t);return t},n.hasProperty=a,n.hasMethod=function(e,t){return e instanceof Object&&t in e},n.isFunction=function(e){return e instanceof Function},n.excludeSpecificTasks=s,n.utilClearByTag=function(e){if(!s.call(["locked"],e))return!1;return e.tag===this},n.fifo=function(e,t){return e.createdAt-t.createdAt},n.lifo=function(e,t){return t.createdAt-e.createdAt},n.log=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0!==this)return void localStorage.removeItem("debug");localStorage.setItem("debug","worker:*");(0,i.default)("worker:"+t+" ->")(r.default.get(o.default,e))};var r=u(e("object-path")),i=u(e("debug")),o=u(e("./enum/log.events"));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e){var t=Array.isArray(this)?this:["freezed","locked"],n=[],r=!0,i=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value;n.push(!1===a(e,c)||!1===e[c])}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return!(n.indexOf(!1)>-1)}},{"./enum/log.events":12,debug:2,"object-path":6}]},{},[15]);